<!DOCTYPE html>
<html>
  <head>
    <title>Object Dance Party</title>
    <link rel="stylesheet" type="text/css" href="styles.css" />
    <script src="lib/jquery.js"></script>
    <script src="src/dancer.js"></script>
    <script src="src/blinkyDancer.js"></script>
    <script src="src/resizeDancer.js"></script>
    <script src="src/multiColorDancer.js"></script>
    <script src="src/makenyan.js"></script>
    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">

<!-- Latest compiled and minified JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js" integrity="sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS" crossorigin="anonymous"></script>
  
  </head>
  <body>
  
    <div class="topbar">
      <span class="title">object dance party</span>
      <a href="#" class="addDancerButton" data-dancer-maker-function-name="makeBlinkyDancer">Add a Blinky Dancer</a>
      <a href="#" class="addColorButton" data-dancer-maker-function-name2="makeColorDancer">Add a Color Dancer</a> 
      <a href="#" class="addMovingDancer" data-dancer-maker-function-name3="makeMovingDancer">Add a Moving Dancer</a>
      <a href="#" class="addNyan" data-dancer-maker-function-name4="makeNyan">Add a Nyan</a>
      <a href="#" class="alignLeft" data-dancer-maker-function-name3="makeMovingDancer">Align Left</a>
      <a href="#" class="calculate" data-dancer-maker-function-name3="makeMovingDancer">Calculate</a>

      </div>
    <div class='a'></div>
    <div class='b'></div>
    <div class='c'></div>

    <script src="src/init.js"></script>

    <script>
      $(document).ready(function(){
        animateDiv();
        animateDiv2();
        window.setInterval(function() {
          calculate(); }
        , 1000);
      });

      function makeNewPosition(){

    // Get viewport dimensions (remove the dimension of the div)
        var h = $(window).height() - 50;
        var w = $(window).width() - 50;
    
        var nh = Math.floor(Math.random() * h);
        var nw = Math.floor(Math.random() * w);
    
        return [nh,nw];    
    
      }

      function animateDiv(){
        var newq = makeNewPosition();
        var oldq = $('.a').offset();
        var speed = calcSpeed([oldq.top, oldq.left], newq);
        
        $('.a').animate({ top: newq[0], left: newq[1] }, speed, function(){
          animateDiv();        
        });
        
      };
      function animateDiv2(){
        var newq = makeNewPosition();
        var oldq = $('.b').offset();
        var speed = calcSpeed([oldq.top, oldq.left], newq);
        
        $('.b').animate({ top: newq[0], left: newq[1] }, speed, function(){
          animateDiv2();        
        });
        
      };

      function calcSpeed(prev, next) {

        var x = Math.abs(prev[1] - next[1]);
        var y = Math.abs(prev[0] - next[0]);
        
        var greatest = x > y ? x : y;
        
        var speedModifier = 0.1;

        var speed = Math.ceil(greatest/speedModifier);

        return speed;
      };

      function calculate() {
        var collision = function ($div1, $div2) {
          var x1 = $div1.offset().left;
          var y1 = $div1.offset().top;
          var h1 = $div1.outerHeight(true);
          var w1 = $div1.outerWidth(true);
          var b1 = y1 + h1;
          var r1 = x1 + w1;
          var x2 = $div2.offset().left;
          var y2 = $div2.offset().top;
          var h2 = $div2.outerHeight(true);
          var w2 = $div2.outerWidth(true);
          var b2 = y2 + h2;
          var r2 = x2 + w2;
            
          if (b1 < y2 || y1 > b2 || r1 < x2 || x1 > r2) {
            return false;
          }
          
          return true;
        };

        window.setInterval(function() {
            if (collision($('.a'), $('.c'))) {
              console.log('collided');
              $('.c').hide();
            }
        }, 200);

        // for (var i = 0; i < dancers.length; i++) {
        //   var node = $(dancers[i].$node[0]);
        //   window.setInterval(function() {
        //     if (collision($('.a'), node)) {
        //       console.log('collided');
        //       node.hide();
        //     }
        //   }, 200);
        // }
      }
    </script>
  </body>
</html>
